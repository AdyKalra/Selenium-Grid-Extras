<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script type="text/javascript">

        $('document').ready(function () {
        var hostID = -1;
        for (var i = 0; i < nodes.length; i++) {
            var host = nodes[i];
            hostID++;
            var hostUrl = "http://" + host + ":3000";

            $('#nodes').append("<div class='node' id='node" + hostID + "'></div>");
            $('#node' + hostID).append(host);
            $('#node' + hostID).append("<div class='image' id='image"+ hostID +"'></div><br />");
            $('#node' + hostID).append("<a href='" + hostUrl + "/move_mouse' target='new'>Move Mouse</a> | ");
            $('#node' + hostID).append("<a href='" + hostUrl + "/kill_chrome' target='new'>Kill All Chrome</a> | ");
            $('#node' + hostID).append("<a href='" + hostUrl + "/kill_firefox' target='new'>Kill All Firefox</a> | ");
            $('#node' + hostID).append("<a href='" + hostUrl + "/ps' target='new'>Get All Processes</a>");

            var screenShotUrl = hostUrl + '/screenshot?callback=?';
            console.log(hostID);
            getImage(screenShotUrl, hostID);

        }

        function getImage(screenShotUrl, hostID) {
            var currentHostID = hostID;

            $.getJSON(screenShotUrl, '', function (res) {
                console.log(currentHostID);
                $("#image" + currentHostID +"").html("<img id='" + currentHostID + "' class='screenshot' src='data:image/png;base64," + res.image + "' />");
            });
        }

        });

</script>